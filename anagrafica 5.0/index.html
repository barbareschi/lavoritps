<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Anagrafica</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Anagrafica</h1>

<div style="text-align: center; margin-bottom: 20px;">
    <input type="button" value="Svuota elenco" onclick="svuota()">
</div>

<h2>Dati personali</h2>

Nome:<br>
<input type="text" id="nome"><br>

Cognome:<br>
<input type="text" id="cognome"><br>

Anno di nascita:<br>
<input type="number" id="nascita"><br>

Email:<br>
<input type="text" id="email"><br>

<h2>Luogo di residenza</h2>

Regione:<br>
<select id="regione">
    <option value="">Seleziona regione</option>
    <option value="Abruzzo">Abruzzo</option>
    <option value="Basilicata">Basilicata</option>
    <option value="Calabria">Calabria</option>
    <option value="Campania">Campania</option>
    <option value="Emilia-Romagna">Emilia-Romagna</option>
    <option value="Friuli-Venezia Giulia">Friuli-Venezia Giulia</option>
    <option value="Lazio">Lazio</option>
    <option value="Liguria">Liguria</option>
    <option value="Lombardia">Lombardia</option>
    <option value="Marche">Marche</option>
    <option value="Molise">Molise</option>
    <option value="Piemonte">Piemonte</option>
    <option value="Puglia">Puglia</option>
    <option value="Sardegna">Sardegna</option>
    <option value="Sicilia">Sicilia</option>
    <option value="Toscana">Toscana</option>
    <option value="Trentino-Alto Adige">Trentino-Alto Adige</option>
    <option value="Umbria">Umbria</option>
    <option value="Valle d'Aosta">Valle d'Aosta</option>
    <option value="Veneto">Veneto</option>
</select><br>

Indirizzo:<br>
<input type="text" id="indirizzo"><br>

CAP:<br>
<input type="text" id="cap"><br>

<h2>Genere</h2>
<input type="radio" name="genere" value="Femmina"> Femmina<br>
<input type="radio" name="genere" value="Maschio"> Maschio<br>
<input type="radio" name="genere" value="Altro"> Altro<br>

<h2>Mezzi posseduti</h2>
<input type="checkbox" class="mezzo" value="Bicicletta"> Bicicletta<br>
<input type="checkbox" class="mezzo" value="Automobile"> Automobile<br>
<input type="checkbox" class="mezzo" value="Moto"> Moto<br>
<input type="checkbox" class="mezzo" value="Scooter"> Scooter<br>
<input type="checkbox" class="mezzo" value="Autobus"> Autobus<br>
<input type="checkbox" class="mezzo" value="Treno"> Treno<br>
<input type="checkbox" class="mezzo" value="Monopattino elettrico"> Monopattino elettrico<br>

<h2>Sport</h2>
<select id="sport" multiple>
    <option>Palestra</option>
    <option>Pallavolo</option>
    <option>Nuoto</option>
    <option>Calcio</option>
    <option>Tennis</option>
    <option>Basket</option>
    <option>Pallanuoto</option>
    <option>Ciclismo</option>
    <option>Equitazione</option>
    <option>Arti marziali</option>
    <option>Sci</option>
</select>

<br><br>
<input type="button" value="Inserisci" onclick="salva()">
<br><br>

<a href="destinatario.html">Stampa</a>

<script>
let elenco = [];

let regexNome = /^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$/;
let regexCognome = /^[A-Za-zÀ-ÖØ-öø-ÿ\s]+$/;
let regexCap = /^[0-9]+$/;
let regexEmail = /^[^\s@]+@[^\s@]+\.[A-Za-z]{2,6}$/;

function salva() {
    let dati = localStorage.getItem("elenco");
    if (dati != null) {
        elenco = JSON.parse(dati);
    }

    let nome = document.getElementById("nome").value;
    let cognome = document.getElementById("cognome").value;
    let cap = document.getElementById("cap").value;
    let email = document.getElementById("email").value;

    // VALIDAZIONI
    if (!regexNome.test(nome)) {
        alert("Nome non valido (solo lettere)");
        return;
    }

    if (!regexCognome.test(cognome)) {
        alert("Cognome non valido (solo lettere)");
        return;
    }

    if (!regexCap.test(cap)) {
        alert("CAP non valido (solo numeri)");
        return;
    }

    if (!regexEmail.test(email)) {
        alert("Email non valida");
        return;
    }

    let persona = {
        nome: nome,
        cognome: cognome,
        nascita: document.getElementById("nascita").value,
        regione: document.getElementById("regione").value,
        indirizzo: document.getElementById("indirizzo").value,
        cap: cap,
        email: email,
        genere: "",
        mezzi: [],
        sport: []
    };

    let generi = document.getElementsByName("genere");
    for (let i = 0; i < generi.length; i++) {
        if (generi[i].checked) {
            persona.genere = generi[i].value;
        }
    }

    let mezzi = document.getElementsByClassName("mezzo");
    for (let i = 0; i < mezzi.length; i++) {
        if (mezzi[i].checked) {
            persona.mezzi.push(mezzi[i].value);
        }
    }

    let sportOpt = document.getElementById("sport").options;
    for (let i = 0; i < sportOpt.length; i++) {
        if (sportOpt[i].selected) {
            persona.sport.push(sportOpt[i].value);
        }
    }

    elenco.push(persona);
    localStorage.setItem("elenco", JSON.stringify(elenco));

    document.getElementById("nome").value = "";
    document.getElementById("cognome").value = "";
    document.getElementById("nascita").value = "";
    document.getElementById("email").value = "";
    document.getElementById("indirizzo").value = "";
    document.getElementById("cap").value = "";
    document.getElementById("regione").selectedIndex = 0;

    for (let i = 0; i < generi.length; i++) generi[i].checked = false;
    for (let i = 0; i < mezzi.length; i++) mezzi[i].checked = false;
    for (let i = 0; i < sportOpt.length; i++) sportOpt[i].selected = false;
}

function svuota() {
    localStorage.removeItem("elenco");
}
</script>

</body>
</html>
